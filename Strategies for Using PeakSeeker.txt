Strategies for using PeakSeeker:

************************
--*STARTING PARAMETERS*--

-Run in either Automatic mode or Manual mode.
	-Automatic mode:
		-The program tries to find charge envelopes, starting from the most intense peak.
		-It can make mistakes, based on the scoring function. See the section "Charge State Assignment" below. 
	
	-Manual mode:
		-The user can choose which peak to deconvolute, and which charge state is the best answer from a list of charge states.
		-The program works by displaying the spectrum with a list of options.
			-For a short time, the user can interact with the display: e.g. zooming, moving the display, saving the picture.
			-However, the command line cannot be interacted with during that time.
			-This time can be set in PeakDispTime and ChargeDispTime.
			-Then, the display will close, and the user can enter a choice, or choose to cancel.

-Limit the charge state range, mass range, and m/z window to those which are desired. This can improve runtimes.

************************
--*PROCESSING*--

-Make sure only the desired processing (background remove, smoothing, or Savitzky-Golay) is turned on.

-The Savitzky-Golay filter preserves peak shape better than the Smooth. 

************************
--*PEAK DETECTION*--

-There are 3 PeakFindWays: i, c, and m. 
	-i simply finds local maxima. This should be used with a filter in case of noisy spectra. This works for most spectra. 
	-c performs a continuous wavelet transform. This is useful for very noisy spectra. See scipy.signal.find_peaks_cwt
	-m uses Massign's fixed and adjusted threshold. See the SI of Morgner, N.; Robinson, C. Anal. Chem. 2012, 84, 2939-2948. 

-Turn JustPeaks on to see which peaks are detected before running the whole program workflow.

-Adjust Threshold so that small noisy peaks are filtered out.

-If you notice odd peak shapes, there may be overlapping signals. Use FindOverlaps.


************************
--*CHARGE STATE ASSIGNMENT*--

-Set the Mass Tolerance equal to about half of the FWHM of a typical peak in the spectrum.
	-Make the Mass Tolerance big enough so that you're finding the peaks close to the simulated peak.
	-Make the Mass Tolerance small enough so that you don't find too many wrong peaks close to the simulated peak.

	-EXPLANATION: when we iterate charge states, we calculate the m/zs at other charge states. Then, we search for peaks that correspond to those other m/zs. If the m/z is within the Mass Tolerance away from a peak's centroid, then that peak is considered. If there are multiple peaks found, the one that has the least deviation from the simulated peak is deemed correct. This deviation is determined by the scoring function.

-The Scoring Function determines:
	1) which real peak is closest to the simulated peak in the simulated charge envelope.
	2) how well the simulated peak approximates the real peak, and therefore how well the simulated charge envelope fits the spectrum.
	3) the correct charge state in Automatic Mode.

-THE SCORING FUNCTION MAKES MISTAKES.
	-It can give preference to charge states that find less numbers of peaks, because it is easier for them to fit into a simulated charge 	envelope.
		-This can happen with charge states that are 1 off the true charge state, or charge states that are half the true charge state.
		-Use min_peak_num to filter those out.

-Prefer mass error over height error for spectra with many different peaks.
	ScoreLimit: 50000
	MassErrWeight: 50000
	HeightErrWeight: 100
	WidthErrWeight: Doesn't really matter

-Prefer height error over mass error for spectra with overlapping peaks.
	ScoreLimit: 50000
	MassErrWeight: 1000
	HeightErrWeight: 500
	WidthErrWeight: Doesn't really matter

-AttemptLim is the numper of charge states the program will test; i.e. the number of options the user can choose from.

-The program will try to find as many envelopes as in MaxSimulations BEFORE SUBTRACTING.
	-The peaks in a given charge envelope can be selected from previous charge envelopes, since there is the possibility of overlapping peaks. 
	-Possible problems:
		-Later envelopes may erroneously find peaks that have already been accounted for.
		-If MaxSimulations is too large and many envelopes share the same peaks, the program may come up with negative or very big 				abundances, since it will try to fit all of the envelopes at the same time.
	-Use Manual Mode to choose the correct peaks.
	-Use RepeatSearch so you don't have to fit all of them at the same time. This subtracts the found envelopes and repeat searching.

-Subtracting and refitting via the UseSubtract option is not recommended.


************************
--*DISPLAYS AND SAVING SUBTRACTED SPECTRUM, MASS INFORMATION*--

-Displays can be zoomed in (magnifying glass image) and out.
-The window can be shifted (the cross with arrows image). 
-The pictures can be saved in one of several formats (save file image).
-You can go back to the original display. (home image)
-See matplotlib for more ways to manipulate.

-SaveSubtract saves the subtracted spectrum as a text file in the same directory as the original spectrum, with the same header.

-SaveMasses saves the mass information as a text file in the same directory as the original spectrum.
